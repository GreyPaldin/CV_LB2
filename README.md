#   Проект лабораторной работы №2 по дисциплине "Системы копьютерного зрения"
##  Основная информация о задании
&ensp; В рамках данной работы было необходимо реализовать методы поиска и сопоставления опорных точек на двух изображениях, имеющих друг относительно друга смещение.

##  Выбор метода обнаружения
&ensp; Во многом мы ограничены двумя вариантами с некоторым числом модификаций внутри них.

&ensp; Первый варант - поиск углов. Данный метод хорошо работает с изображениями, имеющими достаточно явно выраженные прямые линии и, соответсвенно, углов, образуемых между ними. Чаще всего их применяют для поиска геометрических фигур или сопоставления изображений зданий, панормамм городов или прочих изображений, где будет большое число прямых (или близких к ним) линий.

&ensp; Второй варинат - блобы. Блобы представляют собой некоторую область, которая является достаточно отличительной на фоне остального изображения и может быть сравнительно лего детектированна. Если найти на изображении А набор таких областей, то при незначительных изменениях, с высокой вероятностью все или большая часть этих областей может быть детектирована на изображении B (если мы применяем одинаковые алгоритмы). Однако, стоит заметить, что данный метод не совершенен и часто при сильных изменениях изображений будет происходить серьёзное изменение числа или положения этих самых блобов, что делает невозможность сопоставления блобов. Из особенностей стоит отметить, что у него единственное требование - наличие каких-либо особенностей (переходов яркости, цветовых переходов) на изображении, чтобы их можно было считать этими особыми точками.

&ensp; Для решения задачи в данном проекте будет применятсья метод блобов, так как он более универсален и больше подходит для изображений с не явно выраженными прямыми линиями.

##  Описание хода работы
#   Искажение исходного изображения

&ensp; Для работы было взято случайно изображение с интернета, сложность работы с которым заранее является высокой ввиду однотонности палитры и малого числа объектов, за которые дейсвтительно можно зацепиться блобами (но было бы лего зацепиться фильтром углов). Изображение приведено ниже и оно имеет размер 1280x720.

![alt text](one.jpg)

&ensp; Чтобы исказить изображение, достаточно поменять его яркость или же как-то сместить пиксели. Для внесения изменений в изображении было использован сервис yodayo, а конкретно функция расширения изображения. Исходное изображение было загружено и увеличено до размеров 1865x1227. Новые пиксели были созданы генератором изображения и, фактически, просто дополнили исходную картину, не затронув её. Стоит отметить, что метод может быть не идеален, так как иходное изображение может быть подвергнуто изменению по гамме, более того, исходное изображение было в формтае jpg, а выходное - png, которое потом конвертировалось в jpg.

&ensp; Дополненное изображение представлено ниже.

![alt text](generate.jpg)

&ensp; На этом модификация изображений остановлена, переходим к непосредственно блобам.

#   Алгоритм обнаружения блобов (blob)

### Бинаризация

&ensp; Как ранее говорилось - блоб - это особая область, которая отличается или выделяется на фоне остального изображения (если быть вернее, в определённой его окрестности). Для подобной задачи работа с цветным, цифровым изображением, крайне неудобна ввиду того, что изображение содержит огромное количество информции. Поэтому для упрощения работы предварительно оба изображения будут бинаризоваться, ранее мы рассматривали как работает данный алгоритм в лабораторной работе №1. Стоит отметить, что исходное изображениие далее будет обозначаться как изображение 1 и искажённое (расширенное) как изображение 2. Результат бинаризации обоих изображений представлен ниже.

![alt text](Бинаризация.png)

&ensp; Стоит замтеить, что важно подобрать порог бинаризации (threshold), так как в зависимости от него в итоге будет получатсья разное количество и качество областей (об этом будет далее). При низком пороге - у нас будет больше областей и при этом будут поподать шумы. При высоком пороге - будет меньше областей (но не всегда) и, возможно, что часть областей будут поглащать друг друга, сливаясь в одну область (такое не исключено и при низком пороге, так как сильно зависит от особенностей изображения).

### Определение связей

&ensp; Данный этап нужен для того, чтобы разбить бинаризированное изображение на набор связанных блоков пикселей. Которые, фактически, будут формировать областит, которые в дальнейшем будут анализироваться. 

&ensp; Для определения связей использовалась функция label из библиотеки scipy.ndimage. Как итог, на выходе получается массив размером с изображение, состоящий из чисел в диапозоне от 0 до N, где N - число обнаруженных связанных пикселей (формирующих область N). Поэтому пятно пикселей с значением 1, будут формировать область номер 1. Пятно из пикселей с значением 2 - будет формировать область номер 2 и так далее.

&ensp; Так же можно рассматривать несколько видов связей, в частности, 4 или 8 связность, в первом случаи пиксель считается связанным, если он контактирует с другими такими же пикселями по какой либо из сторон. В втором случаи к условию добавляются диагонали и достаточно, чтобы углы пикселей, а не стороны, касались друг друга.

&ensp; Ниже приведены графические отображения работы алгоритма. Для изображения 1.

![alt text](Связывание1.png)

&ensp; В данном случаи был сделан цветной градиент, где каждый цвет или его оттенок показывает принадлежность к той или иной области.

&ensp; Так же был выведен список всех областей с числом пикселей, так как по цветной шкале трудно понять, скольок всего было обнаружено областей, но на основе выводимый справочойно информации можно сделать вывод, что было сформировано около 397 областей. Однако многие из них состоят из всего лишь пары пикселей или пары десятков, такие блобы мы не увидим графически, но при этом они составляют большую часть изображения.

&ensp; Ниже приведены графические отображения работы алгоритма. Для изображения 2.

![alt text](Связывание2.png)

&ensp; Здесь же, несмотря на расширение изображения, было сформированно всего 334 области, что меньше, чем на первом изображении. Вероятнее всего, исходное изображение было искажено в генераторе краёв и при измеении форматов. Однако, для текущей задачи это не кретично.

### Фильтрация областей и формировние блобов

&ensp; Как было ранее сказанно, метод связей обнаружил около 300-400 связанных областей, каждая из которых могла бы стать потенциальным блобом. Однако, работать с таким числом точек было бы крайне неудобно, более того, достаточно большчая их часть представляет собой области в несколько пикселей, а другие - в несколько сотен пикселей. Как итог, вводится пороговое значение на минимальнуб площадь блоба (min_area), задаваемую пользователем. В данном с случаи при значении в 50 пикселей были достигнуты приемлемые результаты. 

&ensp; Теперь происходит вычисление центров масс блобов, так как у нас есть порог в 50 пикселей, то область вокруг центра масса блоба, попадающая в квадрат с площадью 50 пикселей, будет являться искомым блобом для данной области.

### Сопоставление блобов

&ensp; После того, как была проведена работа по фильтрации областей, было вычисленно число блобов, с которыми будем в дальнейшем работать. Для первого изображения это -, и для второго -.

&ensp; Теперь необходимо сопостваить блобы, чтобы по ним в дальнейшем можно было сопоставлять изображения  и/или объекты.

&ensp;
  








